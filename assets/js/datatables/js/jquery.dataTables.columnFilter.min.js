
(function(a){a.fn.columnFilter=function(e){var c,y,o,l;var B="du {from} au {to}";var d=new Array();var h=new Array();var z=null;var x=function(){};function C(D,G,J,M,K){if(typeof G=="undefined"){return new Array()}if(typeof J=="undefined"){J=true}if(typeof M=="undefined"){M=true}if(typeof K=="undefined"){K=true}var O;if(M==true){O=D.aiDisplay}else{O=D.aiDisplayMaster}var N=new Array();for(var F=0,I=O.length;F<I;F++){var H=O[F];var E=v.fnGetData(H);var L=E[G];if(K==true&&L.length==0){continue}else{if(J==true&&jQuery.inArray(L,N)>-1){continue}else{N.push(L)}}}return N.sort()}function w(i){if(n.bUseColVis){return i}else{return v.fnSettings().oApi._fnVisibleToColumnIndex(v.fnSettings(),i)}}function q(L,K,N,D,H,O,M,P){var E="text_filter form-control";if(D){E="number_filter form-control"}E+=" "+P;o=o.replace(/(^\s*)|(\s*$)/g,"");var F=L.fnSettings().aoPreSearchCols[y].sSearch;var i="search_init ";var G=o;if(F!=""&&F!="^"){if(D&&F.charAt(0)=="^"){G=F.substr(1)}else{G=F}i=""}var J=a('<input type="text" style="margin: 0 0 0px 0;" class="input-sm '+i+E+'" value="'+G+'" rel="'+y+'" placeholder="'+M+'" />');if(O!=undefined&&O!=-1){J.attr("maxlength",O)}l.html(J);if(D){l.wrapInner('<span class="filter_column filter_number" />')}else{l.wrapInner('<span class="filter_column filter_text" />')}c[y]=o;var I=y;if(D&&!L.fnSettings().oFeatures.bServerSide){J.keyup(function(Q){if(Q.keyCode==13){L.fnFilter("^"+this.value,w(I),true,false);x()}})}else{J.keyup(function(S){if(S.keyCode==13){if(L.fnSettings().oFeatures.bServerSide&&H!=0){var Q=L.fnSettings().aoPreSearchCols[I].sSearch;var R=a(this).data("dt-iLastFilterLength");if(typeof R=="undefined"){R=0}var T=this.value.length;if(Math.abs(T-R)<H){return}else{a(this).data("dt-iLastFilterLength",T)}}L.fnFilter(this.value,w(I),K,N);x()}})}J.focus(function(){if(a(this).hasClass("search_init")){a(this).removeClass("search_init");this.value=""}});J.blur(function(){if(this.value==""){a(this).addClass("search_init");this.value=c[I]}})}function g(D,i){l.html(r(0));var G=D.attr("id")+"_range_from_"+y;var I=a('<input type="text" class="number_range_filter form-control '+i+'" id="'+G+'" rel="'+y+'"/>');l.append(I);l.append(r(1));var F=D.attr("id")+"_range_to_"+y;var H=a('<input type="text" class="number_range_filter form-control '+i+'" id="'+F+'" rel="'+y+'"/>');l.append(H);l.append(r(2));l.wrapInner('<span class="filter_column filter_number_range form-control '+i+'" />');var E=y;h.push(y);D.dataTableExt.afnFiltering.push(function(N,L,K){if(D.attr("id")!=N.sTableId){return true}if(document.getElementById(G)==null){return true}var M=document.getElementById(G).value*1;var J=document.getElementById(F).value*1;var O=L[w(E)]=="-"?0:L[w(E)]*1;if(M==""&&J==""){return true}else{if(M==""&&O<=J){return true}else{if(M<=O&&""==J){return true}else{if(M<=O&&O<=J){return true}}}}return false});a("#"+G+",#"+F,l).enterKey(function(){var K=document.getElementById(G).value*1;var J=document.getElementById(F).value*1;if(K!=0&&J!=0&&K>J){return}D.fnDraw();x()})}function s(E,J,K){var I=B.split(/[}{]/);l.html("");if(J){var H=E.attr("id")+"_range_from_"+y;var F=a('<div class="input-group date maskDatePicker"><input type="text" placeholder="Du" style="min-width:90px;" class="date_min date_range_filter input-sm form-control '+K+'" id="'+H+'" rel="'+y+'"/></div>');var i=E.attr("id")+"_range_to_"+y;var G=a('<div class="input-group date maskDatePicker"><input type="text" placeholder="Au" style="min-width:90px;" class="date_max date_range_filter input-sm form-control '+K+'" id="'+i+'" rel="'+y+'"/></div>')}else{var H=E.attr("id")+"_range_from_"+y;var F=a('<div class="input-group date datePicker"><span style="border-width: 0px; padding-left: 0px; " class="input-group-addon"><i class="material-icons md-dark md-icon-event md-22"></i></span><input type="text" placeholder="Du" style="min-width:90px;" class="date_min date_range_filter input-sm form-control '+K+'" id="'+H+'" rel="'+y+'"/></div>');var i=E.attr("id")+"_range_to_"+y;var G=a('<div class="input-group date datePicker"><span style="border-width: 0px; padding-left: 0px; " class="input-group-addon"><i class="material-icons md-dark md-icon-event md-22"></i></span><input type="text" placeholder="Au" style="min-width:90px;" class="date_max date_range_filter input-sm form-control '+K+'" id="'+i+'" rel="'+y+'"/></div>')}for(ti=0;ti<I.length;ti++){if(I[ti]==n.sDateFromToken){l.append(F)}else{if(I[ti]==n.sDateToToken){l.append(G)}else{l.append(I[ti])}}}l.wrapInner('<span class="filter_column filter_date_range" />');var D=y;h.push(y);E.dataTableExt.afnFiltering.push(function(R,O,N){if(E.attr("id")!=R.sTableId){return true}var M=F.datepicker("getDate");var L=G.datepicker("getDate");if(M==null&&L==null){return true}var Q=null;try{if(O[w(D)]==null||O[w(D)]==""){return false}Q=a.datepicker.parseDate(a.datepicker.regional[""].dateFormat,O[w(D)])}catch(P){return false}if(Q==null){return false}if(M==null&&Q<=L){return true}else{if(M<=Q&&L==null){return true}else{if(M<=Q&&Q<=L){return true}}}return false});a("#"+H+",#"+i,l).enterKey(function(){E.fnDraw();x()})}function t(P,H,L,D,Q,N,G,F,R){if(H==null){H=C(P.fnSettings(),L,true,false,true)}var M=L;var K=P.fnSettings().aoPreSearchCols[y].sSearch;if(K==null||K==""){K=G}var i='<select style="margin: 0 0 0px 0;" class="select2 search_init select_filter input-sm form-control '+R+'" rel="'+y+'"><option value="" class="search_init">-- Tous --</option>';if(F){i='<select style="margin: 0 0 0px 0;" class="select2 search_init select_filter input-sm form-control '+R+'" rel="'+y+'" multiple>'}var J=0;var E=H.length;for(J=0;J<E;J++){if(typeof(H[J])!="object"){var I="";if(escape(H[J])==K||escape(H[J])==escape(K)){I="selected "}i+="<option "+I+' value="'+escape(H[J])+'">'+H[J]+"</option>"}else{var I="";if(N){if(H[J].value==K){I="selected "}i+="<option "+I+'value="'+H[J].value+'">'+H[J].label+"</option>"}else{if(escape(H[J].value)==K){I="selected "}i+="<option "+I+'value="'+escape(H[J].value)+'">'+H[J].label+"</option>"}}}var O=a(i+"</select>");D.html(O);D.wrapInner('<span class="filter_column filter_select" />');if(F){O.change(function(){if(a(this).val()!=""){a(this).removeClass("search_init")}else{a(this).addClass("search_init")}var U=a(this).val();var S=[];if(U==null||U==[]){var T="^(.*)$"}else{a.each(U,function(V,W){S.push(b(W))});var T="^("+S.join("|")+")$"}P.fnFilter(T,M,true,false)})}else{O.change(function(){if(a(this).val()!=""){a(this).removeClass("search_init")}else{a(this).addClass("search_init")}if(N){P.fnFilter(a(this).val(),L,N)}else{P.fnFilter(unescape(a(this).val()),L)}x()});if(K!=null&&K!=""){P.fnFilter(unescape(K),L)}}}function f(D,E,F,H,I,i){var G=D.fnSettings();if((E==null||typeof(E)=="function")&&G.sAjaxSource!=""&&!G.oFeatures.bServerSide){G.aoDrawCallback.push({fn:(function(J,L,K){return function(M){if(M.iDraw==2&&M.sAjaxSource!=null&&M.sAjaxSource!=""&&!M.oFeatures.bServerSide){return t(D,E&&E(M.aoData,M),w(J),L,K,F,H,I,i)}}})(y,l,o),sName:"column_filter_"+y})}t(D,typeof(E)=="function"?null:E,w(y),l,o,F,H,I,i)}function b(i){return i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function A(H,E){var G=y;var I='<div class="dropdown select_filter form-control '+E+'"><a class="dropdown-toggle" data-toggle="dropdown" href="#">'+o+'<b class="caret"></b></a><ul class="dropdown-menu" role="menu"><li data-value=""><a>Show All</a></li>',F,D=H.length;for(F=0;F<D;F++){I+='<li data-value="'+H[F]+'"><a>'+H[F]+"</a></li>"}var i=a(I+"</ul></div>");l.html(i);l.wrapInner('<span class="filterColumn filter_select" />');i.find("li").click(function(){v.fnFilter(a(this).data("value"),G)})}function u(S,D,K){if(D==null){D=C(S.fnSettings(),y,true,true,true)}var I=y;var P="",U,T=D.length;var F=o.replace("%","Perc").replace("&","AND").replace("$","DOL").replace("Â£","STERL").replace("@","AT").replace(/\s/g,"_");F=F.replace(/[^a-zA-Z 0-9]+/g,"");var Q=o;if(n.sFilterButtonText!=null||n.sFilterButtonText!=undefined){Q=n.sFilterButtonText}var W=10;var N=12;var M=Math.floor(T/N);if(T%N>0){M=M+1}var E=100/M-2;var J=W*M;if(M==1){E=20}var X='<div style="float:left; min-width: '+E+'%; " >';var Y="</div>";var L=S.attr("id")+F;var H="chkBtnOpen"+L;var G=L+"-flt-toggle";P+='<button id="'+H+'" class="checkbox_filter btn btn-default" > '+Q+"</button>";P+='<div id="'+G+'" title="'+o+'" rel="'+y+'" class="toggle-check ui-widget-content ui-corner-all"  style="width: '+(J)+'%; " >';P+=X;for(U=0;U<T;U++){if(U%N==0&&U!=0){P+=Y+X}var V=D[U];var i=D[U];if(typeof(D[U])=="object"){V=D[U].label;i=D[U].value}P+='<input class="search_init checkbox_filter btn btn-default '+K+'" type="checkbox" id= "'+L+"_cb_"+i+'" name= "'+F+'" value="'+i+'" >'+V+"<br/>";var O=a(P);l.html(O);l.wrapInner('<span class="filter_column filter_checkbox" />');O.change(function(){var aa="";var ab="|";var Z=a('input:checkbox[name="'+F+'"]:checked').size();a('input:checkbox[name="'+F+'"]:checked').each(function(ac){if((ac==0&&Z==1)||(ac!=0&&ac==Z-1)){ab=""}aa=aa.replace(/^\s+|\s+$/g,"");aa=aa+a(this).val()+ab;ab="|"});if(aa!=""){a('input:checkbox[name="'+F+'"]').removeClass("search_init")}else{a('input:checkbox[name="'+F+'"]').addClass("search_init")}S.fnFilter(aa,I,true,false);x()})}a("#"+H).button();a("#"+G).dialog({autoOpen:false,hide:"blind",buttons:[{text:"Reset",click:function(){a('input:checkbox[name="'+F+'"]:checked').each(function(Z){a(this).attr("checked",false);a(this).addClass("search_init")});S.fnFilter("",I,true,false);x();return false}},{text:"Close",click:function(){a(this).dialog("close")}}]});a("#"+H).click(function(){a("#"+G).dialog("open");var Z=a(this);a("#"+G).dialog("widget").position({my:"top",at:"bottom",of:Z});return false});var R=x;x=function(){var Z=a("#"+H);a("#"+G).dialog("widget").position({my:"top",at:"bottom",of:Z});R()}}function m(i,G){var E=y;var F=G.callback(i,G,a(this));var D=a(F);l.html(D)}function r(i){switch(i){case 0:return B.substring(0,B.indexOf("{from}"));case 1:return B.substring(B.indexOf("{from}")+6,B.indexOf("{to}"));default:return B.substring(B.indexOf("{to}")+4)}}var v=this;var p={sPlaceHolder:"head:before",sRangeSeparator:"~",iFilteringDelay:500,aoColumns:null,sRangeFormat:"{from} {to}",sDateFromToken:"from",sDateToToken:"to"};var n=a.extend(p,e);return this.each(function(){if(!v.fnSettings().oFeatures.bFilter){return}c=new Array();var G=v.fnSettings().aoFooter[0];var H=v.fnSettings().nTFoot;var E="tr";if(n.sPlaceHolder=="head:after"){var F=a("tr:first",v.fnSettings().nTHead).detach();if(v.fnSettings().bSortCellsTop){F.prependTo(a(v.fnSettings().nTHead));G=v.fnSettings().aoHeader[1]}else{F.appendTo(a(v.fnSettings().nTHead));G=v.fnSettings().aoHeader[0]}E="tr:last";H=v.fnSettings().nTHead}else{if(n.sPlaceHolder=="head:before"){if(v.fnSettings().bSortCellsTop){var F=a("tr:first",v.fnSettings().nTHead).detach();F.appendTo(a(v.fnSettings().nTHead));G=v.fnSettings().aoHeader[1]}else{G=v.fnSettings().aoHeader[0]}E="tr:first";H=v.fnSettings().nTHead}}a(G).each(function(I){y=I;var J={type:"text",bRegex:false,bSmart:true,iMaxLenght:-1,iFilterLength:0,callback:null,placeholder:"",withoutCalendar:"",classLol:""};if(n.aoColumns!=null){if(n.aoColumns.length<y||n.aoColumns[y]==null){return}J=n.aoColumns[y]}if(typeof(J.placeholder)==="undefined"){J.placeholder=""}if(typeof(J.withoutCalendar)==="undefined"){J.withoutCalendar=0}o=a(a(this)[0].cell).text();if(J.sSelector==null){l=a(a(this)[0].cell)}else{l=a(J.sSelector);if(l.length==0){l=a(a(this)[0].cell)}}if(J!=null){if(J.sRangeFormat!=null){B=J.sRangeFormat}else{B=n.sRangeFormat}switch(J.type){case"null":break;case"number":q(v,true,false,true,J.iFilterLength,J.iMaxLenght,J.placeholder,J.classLol);break;case"select":if(J.bRegex!=true){J.bRegex=false}f(v,J.values,J.bRegex,J.selected,J.multiple,J.classLol);break;case"number-range":g(v,J.classLol);break;case"date-range":s(v,J.withoutCalendar,J.classLol);break;case"checkbox":u(v,J.values,J.classLol);break;case"twitter-dropdown":case"dropdown":A(J.values,J.classLol);break;case"custom":if(null!=J.callback&&undefined!=J.callback){m(v,J)}break;case"text":default:bRegex=(J.bRegex==null?false:J.bRegex);bSmart=(J.bSmart==null?false:J.bSmart);q(v,bRegex,bSmart,false,J.iFilterLength,J.iMaxLenght,J.placeholder,J.classLol);break}}});for(j=0;j<h.length;j++){var D=function(){var I=v.attr("id");return a("#"+I+"_range_from_"+h[j]).val()+n.sRangeSeparator+a("#"+I+"_range_to_"+h[j]).val()};d.push(D)}if(v.fnSettings().oFeatures.bServerSide){var i=v.fnSettings().fnServerData;v.fnSettings().fnServerData=function(I,K,L){for(j=0;j<h.length;j++){var J=h[j];for(k=0;k<K.length;k++){if(K[k].name=="sSearch_"+J){K[k].value=d[j]()}}}K.push({name:"sRangeSeparator",value:n.sRangeSeparator});if(i!=null){if(n.iFilteringDelay!=0){if(z!=null){window.clearTimeout(z)}z=window.setTimeout(function(){try{i(I,K,L,v.fnSettings())}catch(M){i(I,K,L)}},n.iFilteringDelay)}}else{if(n.iFilteringDelay!=0){if(z!=null){window.clearTimeout(z)}z=window.setTimeout(function(){a.getJSON(I,K,function(M){L(M)})},n.iFilteringDelay)}}}}})}})(jQuery);