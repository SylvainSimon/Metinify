
function Ajax_Appel_Messagerie(b,a){displayLoading();$.ajax({type:"POST",url:""+b,success:function(c){$("#Contenue_Cadre_Messagerie").html(c);hideLoading();redraw();if(a!==false){$(".nav-tabs-custom li").attr("class","");$(a).parent("li").attr("class","active")}}})}function displayLoadingChat(){$(".box.direct-chat").append('<div class="overlay"><i class="fa fa-spin material-icons md-icon-spin"></i></div>')}function hideLoadingChat(){$(".box.direct-chat .overlay").remove()}function DiscussionOpen(a){Barre_De_Statut("Ouverture de la discussion...");Icone_Chargement(1);displayLoading();$.ajax({type:"POST",url:"pages/Messagerie/MessagerieView.php",data:{idSupportDiscussion:a},success:function(b){$("#Contenue_Cadre_Messagerie").html(b);Barre_De_Statut("Chargement terminé.");Icone_Chargement(0);hideLoading();redraw()}});return false}function DiscussionArchivage(a,b){bootbox.dialog({message:"Êtes vous sûr de vouloir archiver la discussion ?<br/>Le traitement de la demande sera considéré comme terminé.",animate:false,className:"myBootBox",title:"Confirmation de l'archivage",buttons:{danger:{label:"Annuler",className:"btn-danger",callback:function(){}},success:{label:"Confirmer",className:"btn-primary",callback:function(){Barre_De_Statut("Archivage en cours...");Icone_Chargement(1);$.ajax({type:"POST",url:"pages/Messagerie/ajax/ajaxDiscussionArchivage.php",data:{idDiscussion:a},success:function(c){if(c=="NON"){Barre_De_Statut("Cette discussion ne vous appartient pas.");Icone_Chargement(2)}else{if(b){parent.oTable.fnStandingRedraw()}else{Ajax_Appel_Messagerie("pages/Messagerie/MessagerieInbox.php")}}}})}}}})}function verifPseudo(){pseudo=document.getElementById("SaisiePseudo").value;for(i=0;i<pseudo.length;i++){if((pseudo.charCodeAt(i)>=32&&pseudo.charCodeAt(i)<45)||(pseudo.charCodeAt(i)>45&&pseudo.charCodeAt(i)<48)||(pseudo.charCodeAt(i)>57&&pseudo.charCodeAt(i)<65)||(pseudo.charCodeAt(i)>90&&pseudo.charCodeAt(i)<95)||(pseudo.charCodeAt(i)>95&&pseudo.charCodeAt(i)<97)||(pseudo.charCodeAt(i)>122)&&(pseudo.charCodeAt(i)<128)||(pseudo.charCodeAt(i)>144)&&(pseudo.charCodeAt(i)<147)){document.getElementById("ReponseDuTestPseudo").innerHTML="<span class='text-red'>Caractère(s) non-autorisé(s)</span>";UtilisateurSyntax=1;return}else{UtilisateurSyntax=0}}if(pseudo.length<2){document.getElementById("ReponseDuTestPseudo").innerHTML="<span class='text-red'>Nom d'utilisateur trop court</span>";UtilisateurSyntax=1}else{if(texte=RequeteAJAX("pages/Messagerie/ajax/ajaxVerificationPseudo.php?pseudo="+escape(pseudo))){if(texte==1){document.getElementById("ReponseDuTestPseudo").innerHTML="<span class='text-red'>Nom d'utilisateur déjà utilisé</span>";UtilisateurDispo=1}else{if(texte==2){document.getElementById("ReponseDuTestPseudo").innerHTML="<span class='text-green'>Nom d'utilisateur libre</span>";UtilisateurDispo=0}else{document.getElementById("ReponseDuTestPseudo").innerHTML=texte;UtilisateurDispo=1}}}}}function RequeteAJAX(a){if(window.XMLHttpRequest){xhr_object=new XMLHttpRequest()}else{if(window.ActiveXObject){xhr_object=new ActiveXObject("Microsoft.XMLHTTP")}else{return(false)}}xhr_object.open("GET",a,false);xhr_object.send(null);if(xhr_object.readyState==4){return(xhr_object.responseText)}else{return(false)}}function VerificationFormulairePseudo(){if((UtilisateurSyntax+UtilisateurDispo)==0){$.ajax({type:"POST",url:"pages/Messagerie/ajax/ajaxPseudoCreate.php",data:"Pseudo="+$("#SaisiePseudo").val(),success:function(a){if(a==1){Ajax("pages/Messagerie/Messagerie.php")}}});return false}else{messagederreur="";if(UtilisateurSyntax==1){messagederreur+="- Nom d'utilisateur non-correct\n";verifPseudo()}if((UtilisateurDispo==1)&&(UtilisateurSyntax==0)){messagederreur+="- Le nom d'utilisateur n'est pas disponible.\n";verifPseudo()}alert(messagederreur);messagederreur=""}};